{
  "datasets": [
    {
      "name": "ds_daily_kpis_costs",
      "displayName": "Daily Compliance, Adoption, and Raw Cost",
      "queryLines": [
        "SELECT k.date AS date, k.plant_id AS plant_id, k.line_id AS line_id, k.sku_id AS sku_id, (k.compliance_rate_pct/100.0) AS compliance_rate, (k.adoption_rate_pct/100.0) AS adoption_rate, c.avg_cost_per_mt_usd AS avg_cost_per_mt_usd FROM brlui.brian_lui_mccain.gold_blend_hourly_kpis k INNER JOIN brlui.brian_lui_mccain.gold_blend_costs c ON k.date = c.date AND k.plant_id = c.plant_id AND k.line_id = c.line_id AND k.sku_id = c.sku_id ORDER BY k.date ASC "
      ]
    },
    {
      "name": "ds_hourly_quality",
      "displayName": "Hourly Blend Quality vs PSS",
      "queryLines": [
        "SELECT plant_id, line_id, sku_id, hour_bucket, dry_solids_pct_blend, defect_points_blend, avg_length_mm_blend, sku_min_dry_solids_pct, potato_cost_per_kg_blend, sources, fractions, compliance_flag, alert_dry_band_flag, alert_defect_band_flag, (dry_solids_pct_blend - sku_min_dry_solids_pct) AS dry_gap_to_min_pp, (CASE WHEN dry_solids_pct_blend < sku_min_dry_solids_pct THEN TRUE ELSE FALSE END) AS below_min_flag FROM brlui.brian_lui_mccain.gold_blend_hourly_quality ORDER BY hour_bucket ASC "
      ]
    },
    {
      "name": "ds_source_mix_weekly",
      "displayName": "Weekly Source Mix (Exploded)",
      "queryLines": [
        "SELECT DATE_TRUNC('WEEK', hour_bucket) AS week_start, plant_id, line_id, sku_id, src AS source_id, frac AS fraction_pct FROM (SELECT plant_id, line_id, sku_id, hour_bucket, posexplode(sources) AS (pos_s, src), posexplode(fractions) AS (pos_f, frac) FROM brlui.brian_lui_mccain.gold_blend_hourly_quality) t WHERE t.pos_s = t.pos_f ORDER BY week_start ASC, source_id ASC "
      ]
    },
    {
      "name": "ds_blend_suggestions",
      "displayName": "Optimizer Suggestions & Adoption (Hourly)",
      "queryLines": [
        "SELECT plant_id, line_id, sku_id, hour_bucket, source_id_list, actual_fractions, suggested_fractions, expected_cost_per_kg_usd, (expected_cost_per_kg_usd*1000.0) AS expected_cost_per_mt_usd, compliance_flag, adoption_flag, infeasible_flag, infeasible_reason FROM brlui.brian_lui_mccain.gold_blend_suggestions ORDER BY hour_bucket DESC "
      ]
    },
    {
      "name": "ds_downstream_penalties_weekly",
      "displayName": "Weekly Downstream Penalties by Type",
      "queryLines": [
        "SELECT week_start, plant_id, line_id, sku_id, disposition_type, penalties_usd FROM brlui.brian_lui_mccain.gold_downstream_penalties ORDER BY week_start ASC "
      ]
    },
    {
      "name": "ds_supplier_variety_weekly",
      "displayName": "Supplier Variety Reliability (Weekly)",
      "queryLines": [
        "SELECT week_start, plant_id, line_id, sku_id, supplier_id, variety, supplier_region, loads, volume_kg, mean_dry_solids_pct, mean_defect_points, mismatch_rate, mismatch_loads FROM brlui.brian_lui_mccain.gold_supplier_variety_contributors ORDER BY week_start ASC "
      ]
    }
  ],
  "pages": [
    {
      "name": "closed_loop_blend_optimization_canvas",
      "displayName": "closed-loop blend optimization - mccain idaho",
      "layout": [
        {
          "widget": {
            "name": "header_overview",
            "multilineTextboxSpec": {
              "lines": [
                "# Closed-Loop Blend Optimization \u2014 McCain Idaho\n",
                "Executive view to monitor hourly blend quality vs SKU minima, raw potato cost, and downstream penalties. The mid-September anomaly shows increased below-minimum hours and higher penalties. Optimizer suggestions target just-meeting specs at minimal raw cost, reducing downstream penalties and over-quality spend.\n"
              ]
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "kpi_hourly_blend_compliance",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_daily_kpis_costs",
                  "fields": [
                    {
                      "name": "avg(compliance_rate)",
                      "expression": "AVG(`compliance_rate`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg(compliance_rate)",
                  "displayName": "Hourly Blend Compliance",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "title": "KPI: Hourly Blend Compliance (%)",
                "showTitle": true,
                "description": "Share of line-hours meeting SKU minima across the active filter period.",
                "showDescription": true
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 3
          }
        },
        {
          "widget": {
            "name": "kpi_potato_raw_cost_per_mt",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_daily_kpis_costs",
                  "fields": [
                    {
                      "name": "avg(avg_cost_per_mt_usd)",
                      "expression": "AVG(`avg_cost_per_mt_usd`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg(avg_cost_per_mt_usd)",
                  "displayName": "Potato Raw Cost per MT",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 2
                    }
                  }
                }
              },
              "frame": {
                "title": "KPI: Potato Raw Cost per MT ($)",
                "showTitle": true,
                "description": "Average raw potato cost per MT consumed at the line over the filter period.",
                "showDescription": true
              }
            }
          },
          "position": {
            "x": 2,
            "y": 2,
            "width": 2,
            "height": 3
          }
        },
        {
          "widget": {
            "name": "kpi_downstream_penalties_total",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_downstream_penalties_weekly",
                  "fields": [
                    {
                      "name": "sum(penalties_usd)",
                      "expression": "SUM(`penalties_usd`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "sum(penalties_usd)",
                  "displayName": "Downstream Penalties",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  }
                }
              },
              "frame": {
                "title": "KPI: Downstream Penalties ($)",
                "showTitle": true,
                "description": "Total disposition penalties over the filter period.",
                "showDescription": true
              }
            }
          },
          "position": {
            "x": 4,
            "y": 2,
            "width": 1,
            "height": 3
          }
        },
        {
          "widget": {
            "name": "kpi_optimizer_adoption_rate",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_daily_kpis_costs",
                  "fields": [
                    {
                      "name": "avg(adoption_rate)",
                      "expression": "AVG(`adoption_rate`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg(adoption_rate)",
                  "displayName": "Optimizer Adoption",
                  "format": {
                    "type": "number-percent",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  }
                }
              },
              "frame": {
                "title": "KPI: Optimizer Adoption (%)",
                "showTitle": true,
                "description": "Share of hours where suggested blend was followed within tolerance.",
                "showDescription": true
              }
            }
          },
          "position": {
            "x": 5,
            "y": 2,
            "width": 1,
            "height": 3
          }
        },
        {
          "widget": {
            "name": "line_hourly_dry_solids_vs_sku_min",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_hourly_quality",
                  "fields": [
                    {
                      "name": "hour_bucket",
                      "expression": "`hour_bucket`"
                    },
                    {
                      "name": "avg(dry_solids_pct_blend)",
                      "expression": "AVG(`dry_solids_pct_blend`)"
                    },
                    {
                      "name": "avg(sku_min_dry_solids_pct)",
                      "expression": "AVG(`sku_min_dry_solids_pct`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "combo",
              "encodings": {
                "x": {
                  "fieldName": "hour_bucket",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Hour"
                  },
                  "displayName": "Hour"
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "avg(dry_solids_pct_blend)",
                      "displayName": "Actual Blend Dry Solids (%)",
                      "chartType": "line"
                    },
                    {
                      "fieldName": "avg(sku_min_dry_solids_pct)",
                      "displayName": "SKU Minimum Dry Solids (%)",
                      "chartType": "line"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Hourly Blend Dry Solids vs SKU Minimum (Line)",
                "description": "Hourly: actual blend vs SKU minimum. Highlights dips during rain-affected event and recovery.",
                "showDescription": true
              }
            }
          },
          "position": {
            "x": 0,
            "y": 5,
            "width": 3,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "line_cost_vs_compliance_daily",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_daily_kpis_costs",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    },
                    {
                      "name": "avg(avg_cost_per_mt_usd)",
                      "expression": "AVG(`avg_cost_per_mt_usd`)"
                    },
                    {
                      "name": "avg(compliance_rate)",
                      "expression": "AVG(`compliance_rate`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "combo",
              "encodings": {
                "x": {
                  "fieldName": "date",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Date"
                  },
                  "displayName": "Date"
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "avg(avg_cost_per_mt_usd)",
                      "displayName": "Raw Cost per MT ($)",
                      "chartType": "line"
                    },
                    {
                      "fieldName": "avg(compliance_rate)",
                      "displayName": "Compliance (%)",
                      "chartType": "line"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Raw Potato Cost vs Compliance (Daily)",
                "description": "Daily: demonstrates cost-quality tradeoff; optimizer aims at just-meeting targets to minimize cost.",
                "showDescription": true
              }
            }
          },
          "position": {
            "x": 3,
            "y": 5,
            "width": 3,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "bar_weekly_source_mix_grouped",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_source_mix_weekly",
                  "fields": [
                    {
                      "name": "week_start",
                      "expression": "`week_start`"
                    },
                    {
                      "name": "source_id",
                      "expression": "`source_id`"
                    },
                    {
                      "name": "avg(fraction_pct)",
                      "expression": "AVG(`fraction_pct`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "week_start",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Week Start"
                  },
                  "displayName": "Week Start"
                },
                "y": {
                  "fieldName": "avg(fraction_pct)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "Avg Blend Fraction"
                  },
                  "displayName": "Avg Blend Fraction"
                },
                "color": {
                  "fieldName": "source_id",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "Source"
                }
              },
              "mark": {
                "layout": "group"
              },
              "frame": {
                "showTitle": true,
                "title": "Segment Mix by Source (Weekly, Grouped)",
                "description": "Grouped bars show average weekly blend fractions per source; highlights shifts during event window.",
                "showDescription": true
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 3,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "bar_downstream_penalties_stacked_weekly",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_downstream_penalties_weekly",
                  "fields": [
                    {
                      "name": "week_start",
                      "expression": "`week_start`"
                    },
                    {
                      "name": "disposition_type",
                      "expression": "`disposition_type`"
                    },
                    {
                      "name": "sum(penalties_usd)",
                      "expression": "SUM(`penalties_usd`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "week_start",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Week Start"
                  },
                  "displayName": "Week Start"
                },
                "y": {
                  "fieldName": "sum(penalties_usd)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 0
                    }
                  },
                  "axis": {
                    "title": "Total Penalties ($)"
                  },
                  "displayName": "Total Penalties ($)"
                },
                "color": {
                  "fieldName": "disposition_type",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "Disposition Type"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Downstream Disposition Costs by Type (Weekly, Stacked)",
                "description": "Stacked bars: repack, lower price, reblend, blocked stock, re-sample, donation, dump.",
                "showDescription": true
              }
            }
          },
          "position": {
            "x": 3,
            "y": 10,
            "width": 3,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "table_suggested_vs_actual_fractions",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "ds_blend_suggestions",
                  "fields": [
                    {
                      "name": "hour_bucket",
                      "expression": "`hour_bucket`"
                    },
                    {
                      "name": "line_id",
                      "expression": "`line_id`"
                    },
                    {
                      "name": "sku_id",
                      "expression": "`sku_id`"
                    },
                    {
                      "name": "source_id_list",
                      "expression": "`source_id_list`"
                    },
                    {
                      "name": "actual_fractions",
                      "expression": "`actual_fractions`"
                    },
                    {
                      "name": "suggested_fractions",
                      "expression": "`suggested_fractions`"
                    },
                    {
                      "name": "expected_cost_per_mt_usd",
                      "expression": "`expected_cost_per_mt_usd`"
                    },
                    {
                      "name": "compliance_flag",
                      "expression": "`compliance_flag`"
                    },
                    {
                      "name": "adoption_flag",
                      "expression": "`adoption_flag`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "hour_bucket",
                    "displayName": "Date Hour",
                    "type": "timestamp",
                    "displayAs": "datetime",
                    "dateTimeFormat": "yyyy-MM-dd HH:mm",
                    "order": 1
                  },
                  {
                    "fieldName": "line_id",
                    "displayName": "Line",
                    "type": "string",
                    "displayAs": "string",
                    "order": 2
                  },
                  {
                    "fieldName": "sku_id",
                    "displayName": "SKU",
                    "type": "string",
                    "displayAs": "string",
                    "order": 3
                  },
                  {
                    "fieldName": "source_id_list",
                    "displayName": "Sources",
                    "type": "string",
                    "displayAs": "string",
                    "order": 4,
                    "allowHTML": false
                  },
                  {
                    "fieldName": "actual_fractions",
                    "displayName": "Actual Fractions",
                    "type": "string",
                    "displayAs": "string",
                    "order": 5
                  },
                  {
                    "fieldName": "suggested_fractions",
                    "displayName": "Suggested Fractions",
                    "type": "string",
                    "displayAs": "string",
                    "order": 6
                  },
                  {
                    "fieldName": "expected_cost_per_mt_usd",
                    "displayName": "Expected Cost/MT ($)",
                    "type": "float",
                    "displayAs": "number",
                    "numberFormat": "0.00",
                    "order": 7
                  },
                  {
                    "fieldName": "compliance_flag",
                    "displayName": "Compliant?",
                    "type": "boolean",
                    "displayAs": "boolean",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "order": 8
                  },
                  {
                    "fieldName": "adoption_flag",
                    "displayName": "Adopted?",
                    "type": "boolean",
                    "displayAs": "boolean",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "order": 9
                  }
                ]
              },
              "itemsPerPage": 25,
              "frame": {
                "showTitle": true,
                "title": "Suggested vs Actual Fractions (Hourly)",
                "description": "Where suggestions were not followed and the cost/quality impact.",
                "showDescription": true
              }
            }
          },
          "position": {
            "x": 0,
            "y": 15,
            "width": 6,
            "height": 7
          }
        }
      ],
      "pageType": "PAGE_TYPE_CANVAS"
    },
    {
      "name": "global_filters",
      "displayName": "Global Filters",
      "layout": [
        {
          "widget": {
            "name": "filter_date_range",
            "queries": [
              {
                "name": "ds_daily_kpis_costs_date",
                "query": {
                  "datasetName": "ds_daily_kpis_costs",
                  "fields": [
                    {
                      "name": "date",
                      "expression": "`date`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_hourly_quality_hour_bucket",
                "query": {
                  "datasetName": "ds_hourly_quality",
                  "fields": [
                    {
                      "name": "hour_bucket",
                      "expression": "`hour_bucket`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_source_mix_weekly_week_start",
                "query": {
                  "datasetName": "ds_source_mix_weekly",
                  "fields": [
                    {
                      "name": "week_start",
                      "expression": "`week_start`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_blend_suggestions_hour_bucket",
                "query": {
                  "datasetName": "ds_blend_suggestions",
                  "fields": [
                    {
                      "name": "hour_bucket",
                      "expression": "`hour_bucket`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_downstream_penalties_weekly_week_start",
                "query": {
                  "datasetName": "ds_downstream_penalties_weekly",
                  "fields": [
                    {
                      "name": "week_start",
                      "expression": "`week_start`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_supplier_variety_weekly_week_start",
                "query": {
                  "datasetName": "ds_supplier_variety_weekly",
                  "fields": [
                    {
                      "name": "week_start",
                      "expression": "`week_start`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-range-picker",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "date",
                    "displayName": "Date (Daily KPIs & Cost)",
                    "queryName": "ds_daily_kpis_costs_date"
                  },
                  {
                    "fieldName": "hour_bucket",
                    "displayName": "Hour (Hourly Quality & Suggestions)",
                    "queryName": "ds_hourly_quality_hour_bucket"
                  },
                  {
                    "fieldName": "week_start",
                    "displayName": "Week Start (Mix & Penalties)",
                    "queryName": "ds_source_mix_weekly_week_start"
                  },
                  {
                    "fieldName": "hour_bucket",
                    "displayName": "Hour (Suggestions)",
                    "queryName": "ds_blend_suggestions_hour_bucket"
                  },
                  {
                    "fieldName": "week_start",
                    "displayName": "Week Start (Penalties)",
                    "queryName": "ds_downstream_penalties_weekly_week_start"
                  },
                  {
                    "fieldName": "week_start",
                    "displayName": "Week Start (Supplier Variety)",
                    "queryName": "ds_supplier_variety_weekly_week_start"
                  }
                ]
              },
              "frame": {
                "showTitle": true
              }
            }
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_plant_id",
            "queries": [
              {
                "name": "ds_daily_kpis_costs_plant",
                "query": {
                  "datasetName": "ds_daily_kpis_costs",
                  "fields": [
                    {
                      "name": "plant_id",
                      "expression": "`plant_id`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_hourly_quality_plant",
                "query": {
                  "datasetName": "ds_hourly_quality",
                  "fields": [
                    {
                      "name": "plant_id",
                      "expression": "`plant_id`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_source_mix_weekly_plant",
                "query": {
                  "datasetName": "ds_source_mix_weekly",
                  "fields": [
                    {
                      "name": "plant_id",
                      "expression": "`plant_id`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_blend_suggestions_plant",
                "query": {
                  "datasetName": "ds_blend_suggestions",
                  "fields": [
                    {
                      "name": "plant_id",
                      "expression": "`plant_id`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_downstream_penalties_weekly_plant",
                "query": {
                  "datasetName": "ds_downstream_penalties_weekly",
                  "fields": [
                    {
                      "name": "plant_id",
                      "expression": "`plant_id`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_supplier_variety_weekly_plant",
                "query": {
                  "datasetName": "ds_supplier_variety_weekly",
                  "fields": [
                    {
                      "name": "plant_id",
                      "expression": "`plant_id`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "plant_id",
                    "displayName": "Plant",
                    "queryName": "ds_daily_kpis_costs_plant"
                  },
                  {
                    "fieldName": "plant_id",
                    "displayName": "Plant",
                    "queryName": "ds_hourly_quality_plant"
                  },
                  {
                    "fieldName": "plant_id",
                    "displayName": "Plant",
                    "queryName": "ds_source_mix_weekly_plant"
                  },
                  {
                    "fieldName": "plant_id",
                    "displayName": "Plant",
                    "queryName": "ds_blend_suggestions_plant"
                  },
                  {
                    "fieldName": "plant_id",
                    "displayName": "Plant",
                    "queryName": "ds_downstream_penalties_weekly_plant"
                  },
                  {
                    "fieldName": "plant_id",
                    "displayName": "Plant",
                    "queryName": "ds_supplier_variety_weekly_plant"
                  }
                ]
              },
              "frame": {
                "showTitle": true
              }
            }
          },
          "position": {
            "x": 0,
            "y": 2,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_line_id",
            "queries": [
              {
                "name": "ds_daily_kpis_costs_line",
                "query": {
                  "datasetName": "ds_daily_kpis_costs",
                  "fields": [
                    {
                      "name": "line_id",
                      "expression": "`line_id`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_hourly_quality_line",
                "query": {
                  "datasetName": "ds_hourly_quality",
                  "fields": [
                    {
                      "name": "line_id",
                      "expression": "`line_id`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_source_mix_weekly_line",
                "query": {
                  "datasetName": "ds_source_mix_weekly",
                  "fields": [
                    {
                      "name": "line_id",
                      "expression": "`line_id`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_blend_suggestions_line",
                "query": {
                  "datasetName": "ds_blend_suggestions",
                  "fields": [
                    {
                      "name": "line_id",
                      "expression": "`line_id`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_downstream_penalties_weekly_line",
                "query": {
                  "datasetName": "ds_downstream_penalties_weekly",
                  "fields": [
                    {
                      "name": "line_id",
                      "expression": "`line_id`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_supplier_variety_weekly_line",
                "query": {
                  "datasetName": "ds_supplier_variety_weekly",
                  "fields": [
                    {
                      "name": "line_id",
                      "expression": "`line_id`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "line_id",
                    "displayName": "Line",
                    "queryName": "ds_daily_kpis_costs_line"
                  },
                  {
                    "fieldName": "line_id",
                    "displayName": "Line",
                    "queryName": "ds_hourly_quality_line"
                  },
                  {
                    "fieldName": "line_id",
                    "displayName": "Line",
                    "queryName": "ds_source_mix_weekly_line"
                  },
                  {
                    "fieldName": "line_id",
                    "displayName": "Line",
                    "queryName": "ds_blend_suggestions_line"
                  },
                  {
                    "fieldName": "line_id",
                    "displayName": "Line",
                    "queryName": "ds_downstream_penalties_weekly_line"
                  },
                  {
                    "fieldName": "line_id",
                    "displayName": "Line",
                    "queryName": "ds_supplier_variety_weekly_line"
                  }
                ]
              },
              "frame": {
                "showTitle": true
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_sku_id",
            "queries": [
              {
                "name": "ds_daily_kpis_costs_sku",
                "query": {
                  "datasetName": "ds_daily_kpis_costs",
                  "fields": [
                    {
                      "name": "sku_id",
                      "expression": "`sku_id`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_hourly_quality_sku",
                "query": {
                  "datasetName": "ds_hourly_quality",
                  "fields": [
                    {
                      "name": "sku_id",
                      "expression": "`sku_id`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_source_mix_weekly_sku",
                "query": {
                  "datasetName": "ds_source_mix_weekly",
                  "fields": [
                    {
                      "name": "sku_id",
                      "expression": "`sku_id`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_blend_suggestions_sku",
                "query": {
                  "datasetName": "ds_blend_suggestions",
                  "fields": [
                    {
                      "name": "sku_id",
                      "expression": "`sku_id`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_downstream_penalties_weekly_sku",
                "query": {
                  "datasetName": "ds_downstream_penalties_weekly",
                  "fields": [
                    {
                      "name": "sku_id",
                      "expression": "`sku_id`"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "ds_supplier_variety_weekly_sku",
                "query": {
                  "datasetName": "ds_supplier_variety_weekly",
                  "fields": [
                    {
                      "name": "sku_id",
                      "expression": "`sku_id`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "sku_id",
                    "displayName": "SKU",
                    "queryName": "ds_daily_kpis_costs_sku"
                  },
                  {
                    "fieldName": "sku_id",
                    "displayName": "SKU",
                    "queryName": "ds_hourly_quality_sku"
                  },
                  {
                    "fieldName": "sku_id",
                    "displayName": "SKU",
                    "queryName": "ds_source_mix_weekly_sku"
                  },
                  {
                    "fieldName": "sku_id",
                    "displayName": "SKU",
                    "queryName": "ds_blend_suggestions_sku"
                  },
                  {
                    "fieldName": "sku_id",
                    "displayName": "SKU",
                    "queryName": "ds_downstream_penalties_weekly_sku"
                  },
                  {
                    "fieldName": "sku_id",
                    "displayName": "SKU",
                    "queryName": "ds_supplier_variety_weekly_sku"
                  }
                ]
              },
              "frame": {
                "showTitle": true
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_source_id",
            "queries": [
              {
                "name": "ds_source_mix_weekly_source",
                "query": {
                  "datasetName": "ds_source_mix_weekly",
                  "fields": [
                    {
                      "name": "source_id",
                      "expression": "`source_id`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "source_id",
                    "displayName": "Source ID",
                    "queryName": "ds_source_mix_weekly_source"
                  }
                ]
              },
              "frame": {
                "showTitle": true
              }
            }
          },
          "position": {
            "x": 0,
            "y": 8,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "filter_variety",
            "queries": [
              {
                "name": "ds_supplier_variety_weekly_variety",
                "query": {
                  "datasetName": "ds_supplier_variety_weekly",
                  "fields": [
                    {
                      "name": "variety",
                      "expression": "`variety`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "variety",
                    "displayName": "Variety",
                    "queryName": "ds_supplier_variety_weekly_variety"
                  }
                ]
              },
              "frame": {
                "showTitle": true
              }
            }
          },
          "position": {
            "x": 0,
            "y": 10,
            "width": 2,
            "height": 2
          }
        }
      ],
      "pageType": "PAGE_TYPE_GLOBAL_FILTERS"
    }
  ],
  "uiSettings": {
    "theme": {
      "widgetHeaderAlignment": "ALIGNMENT_UNSPECIFIED"
    }
  }
}